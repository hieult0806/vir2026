/**
 * Realistic Page Flip Effects - Optimized Version
 * Enhanced 3D animations without CSP conflicts or shadow flickering
 */

/* Override and enhance book perspective */
.book-wrapper {
    perspective: 2800px !important;
}

/* Enhanced flip page with realistic motion AND smooth shadow transitions */
.flip-page {
    transition:
        transform 1s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        box-shadow 0.3s ease !important; /* Smooth shadow fade */
}

.flip-page.flipping {
    transition:
        transform 0.85s cubic-bezier(0.25, 0.46, 0.45, 0.94),
        box-shadow 0.3s ease !important; /* Smooth shadow fade */
}

/* Smooth shadow transitions for page surfaces */
.page-front,
.page-back {
    transition: box-shadow 0.3s ease !important; /* KEY FIX: Smooth shadow changes */
}

/* Base shadows - subtle and clean */
.page-front {
    box-shadow:
        -2px 0 10px rgba(0,0,0,0.08),
        0 2px 20px rgba(0,0,0,0.06),
        inset 15px 0 40px rgba(0,0,0,0.04),
        inset -2px 0 10px rgba(255,255,255,0.3) !important;
}

.page-back {
    box-shadow:
        2px 0 10px rgba(0,0,0,0.08),
        0 2px 20px rgba(0,0,0,0.06),
        inset -15px 0 40px rgba(0,0,0,0.04),
        inset 2px 0 10px rgba(255,255,255,0.3) !important;
}

/* Enhanced shadows DURING the flip - smoothly transitions */
.flip-page.flipping .page-front {
    box-shadow:
        -4px 2px 18px rgba(0,0,0,0.15),
        0 4px 30px rgba(0,0,0,0.12),
        inset 20px 0 50px rgba(0,0,0,0.06),
        inset -3px 0 15px rgba(255,255,255,0.4) !important;
}

.flip-page.flipping .page-back {
    box-shadow:
        4px 2px 18px rgba(0,0,0,0.15),
        0 4px 30px rgba(0,0,0,0.12),
        inset -20px 0 50px rgba(0,0,0,0.06),
        inset 3px 0 15px rgba(255,255,255,0.4) !important;
}

/* Hover effect - subtle corner lift */
.flip-page:not(.flipped):hover {
    transform: rotateY(-1.5deg);
    transition: transform 0.25s ease;
}

.flip-page.flipped:hover {
    transform: rotateY(-181.5deg);
    transition: transform 0.25s ease;
}

/* Enhanced spine shadows with smooth transitions */
.page-front::before {
    width: 50px !important;
    background: linear-gradient(
        to right,
        rgba(0,0,0,0.16) 0%,
        rgba(0,0,0,0.09) 25%,
        rgba(0,0,0,0.04) 50%,
        rgba(0,0,0,0.02) 75%,
        transparent 100%
    ) !important;
    transition: opacity 0.3s ease !important; /* Smooth spine fade */
}

.page-back::before {
    width: 50px !important;
    background: linear-gradient(
        to left,
        rgba(0,0,0,0.14) 0%,
        rgba(0,0,0,0.07) 25%,
        rgba(0,0,0,0.03) 50%,
        rgba(0,0,0,0.01) 75%,
        transparent 100%
    ) !important;
    transition: opacity 0.3s ease !important; /* Smooth spine fade */
}

/* Enhanced book shadow - more realistic */
.book::after {
    bottom: -60px !important;
    left: 8% !important;
    width: 84% !important;
    height: 60px !important;
    background: radial-gradient(
        ellipse,
        rgba(0,0,0,0.45) 0%,
        rgba(0,0,0,0.22) 35%,
        transparent 65%
    ) !important;
    filter: blur(25px) !important;
    transition: opacity 0.3s ease !important; /* Smooth base shadow */
}

/* Static page shadows enhanced */
.static-page {
    box-shadow:
        inset -12px 0 35px rgba(0,0,0,0.12),
        2px 0 6px rgba(0,0,0,0.08) !important;
    transition: box-shadow 0.3s ease !important;
}

.static-page-right {
    box-shadow:
        inset 12px 0 35px rgba(0,0,0,0.12),
        -2px 0 6px rgba(0,0,0,0.08) !important;
    transition: box-shadow 0.3s ease !important;
}

/* Book spine enhanced */
.book-spine {
    background: linear-gradient(
        90deg,
        rgba(0,0,0,0.42) 0%,
        rgba(0,0,0,0.62) 25%,
        rgba(0,0,0,0.72) 50%,
        rgba(0,0,0,0.62) 75%,
        rgba(0,0,0,0.42) 100%
    ) !important;
    box-shadow:
        0 0 12px rgba(0,0,0,0.35),
        inset 0 0 6px rgba(0,0,0,0.65) !important;
}

/* Subtle book tilt for realism */
.book {
    transform: rotateX(2.5deg) !important;
}

/* Performance optimizations */
.flip-page,
.page-front,
.page-back {
    will-change: transform !important;
    backface-visibility: hidden !important;
    -webkit-backface-visibility: hidden !important;
}

/* Remove any paper texture that might cause CSP issues */
.page-front::after,
.page-back::after {
    opacity: 0.02 !important;
    transition: opacity 0.3s ease !important; /* Smooth texture fade */
}

/* Mobile optimizations */
@media (max-width: 950px) {
    .book-wrapper {
        perspective: 2200px !important;
    }

    .flip-page {
        transition:
            transform 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94),
            box-shadow 0.2s ease !important;
    }

    .flip-page.flipping {
        transition:
            transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94),
            box-shadow 0.2s ease !important;
    }

    /* Simplified shadows on mobile for performance */
    .page-front {
        box-shadow:
            -2px 0 8px rgba(0,0,0,0.1),
            0 2px 15px rgba(0,0,0,0.08) !important;
    }

    .page-back {
        box-shadow:
            2px 0 8px rgba(0,0,0,0.1),
            0 2px 15px rgba(0,0,0,0.08) !important;
    }
}

/* Reduced motion accessibility */
@media (prefers-reduced-motion: reduce) {
    .flip-page,
    .flip-page.flipping,
    .page-front,
    .page-back {
        transition: transform 0.3s ease !important;
    }

    .flip-page:hover {
        transform: none !important;
    }
}
